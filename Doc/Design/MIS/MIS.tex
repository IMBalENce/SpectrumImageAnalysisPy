\documentclass[12pt, titlepage]{article}

\usepackage{amsmath, mathtools}

\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{xr}
\usepackage{xr-hyper}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{xfrac}
\usepackage{tabularx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{fullpage}


\hypersetup{
bookmarks=true,     % show bookmarks bar?
colorlinks=true,       % false: boxed links; true: colored links
linkcolor=red,          % color of internal links (change box color with linkbordercolor)
citecolor=blue,      % color of links to bibliography
filecolor=magenta,  % color of file links
urlcolor=cyan          % color of external links
}
\externaldocument{../../SRS/SRS}
\usepackage{array}

\input{../../Comments}

\newcommand{\progname}{SpectrumImageAnalysisPy}

\begin{document}
\label{doc:MIS}
\bibliographystyle{ieeetr}
\title{Module Interface Specification for \progname{}}

\author{Isobel Bicket}

\date{\today}

\maketitle

\pagenumbering{roman}

\section{Revision History}

\begin{tabularx}{\textwidth}{p{4cm}p{2cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Notes}\\
\midrule
	November 29, 2017 & 1.0 & Initial draft\\
\bottomrule
\end{tabularx}

~\newpage

\section{Symbols, Abbreviations and Acronyms}

See \hyperref[doc:SRS]{SRS} documentation at \url{https://github.com/icbicket/SpectrumImageAnalysisPy/blob/SpectrumImageAnalysisPy_dev/Doc/SRS/SRS.pdf}.

\newpage

\tableofcontents

\newpage

\pagenumbering{arabic}

\section{Introduction}

The following document details the Module Interface Specifications for
\progname, a library created for the data processing of spectrum image datasets.

Complementary documents include the System Requirement Specifications
and Module Guide.  The full documentation and implementation can be
found at \url{https://github.com/icbicket/SpectrumImageAnalysisPy/tree/SpectrumImageAnalysisPy_dev}.

\section{Notation}

\wss{You should describe your notation.  You can use what is below as
  a starting point.}

The structure of the MIS for modules comes from \cite{HoffmanAndStrooper1995},
with the addition that template modules have been adapted from
\cite{GhezziEtAl2003}.  The mathematical notation comes from Chapter 3 of
\cite{HoffmanAndStrooper1995}.  For instance, the symbol := is used for a
multiple assignment statement and conditional rules follow the form $(c_1
\Rightarrow r_1 | c_2 \Rightarrow r_2 | ... | c_n \Rightarrow r_n )$.

The following table summarizes the primitive data types used by \progname. 

\begin{center}
\renewcommand{\arraystretch}{1.2}
\noindent 
\begin{tabular}{l l p{7.5cm}} 
\toprule 
\textbf{Data Type} & \textbf{Notation} & \textbf{Description}\\ 
\midrule
character & char & a single symbol or digit\\
string & str & a sequence of characters\\
integer & $\mathbb{Z}$ & a number without a fractional component in (-$\infty$, $\infty$) \\
natural number & $\mathbb{N}$ & a number without a fractional component in [1, $\infty$) \\
real & $\mathbb{R}$ & any number in (-$\infty$, $\infty$)\\
\bottomrule
\end{tabular} 
\end{center}

\noindent
The specification of \progname \ uses some derived data types: sequences, strings, and
tuples. Sequences are lists filled with elements of the same data type. Strings
are sequences of characters. Tuples contain a list of values, potentially of
different types. In addition, \progname \ uses functions, which
are defined by the data types of their inputs and outputs. Local functions are
described by giving their type signature followed by their specification.

\section{Module Decomposition}

The following table is taken directly from the Module Guide document for this project.

\begin{table}[h!]
\centering
\input{../MG/ModuleHierarchyTable.tex}
\caption{Module Hierarchy}
\label{TblMH}
\end{table}

\newpage
~\newpage

\section{MIS of Hardware Hiding Module} \label{Mod:HH}

\subsection{Module}

HardwareHiding

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}


\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Behaviour Hiding Module} \label{Mod:BehaviourHiding}

\subsection{Module}

BehaviourHiding

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}


\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Import csv Module} \label{Mod:ImportCSV} 
\subsection{Module}
ImportCSV

\subsection{Uses}
\begin{itemize}
\item \hyperref[Mod:Spectrum]{Data 1D Spectrum}
\item \hyperref[Mod:Array]{Array data structure}
\item \hyperref[Mod:HH]{Hardware-hiding}
\end{itemize}

\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{5cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
ReadCSV & fname: str & Spectrum & NO FILE, NOT CSV\\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
N/A

\subsubsection{Environment Variables}
filesystem

\subsubsection{Access Routine Semantics}

\noindent ReadCSV():\\
ReadCSV reads a .csv file and creates a Spectrum object with the appropriate assignations to intensity and energy range.
\begin{itemize}
	\item input: fname: str
	\item transition: N/A 
	\item output: \hyperref[Mod:Spectrum]{Spectrum}
	\item exceptions:
\end{itemize}
\begin{center}
	\begin{tabular}{p{3cm} p{12cm}}
		\toprule[0.15em]
		\textbf{Exception} & \textbf{Condition}\\
		\midrule[0.1em]
		\multirow{2}{0.25\textwidth}{NO FILE} & The filename does not correspond to any file in the filesystem\\ 
		& $fname \notin filesystem$\\ 
		\midrule[0.05em]
		\multirow{2}{0.25\textwidth}{NOT CSV} & The indicated file is not a *.csv format\\
		& $fname \notin \{files|files \in .csv\}$\\ 
		
		\bottomrule[0.15em]
	\end{tabular}
\end{center}


\section{MIS of Import dm3 Module} \label{Mod:ImportDM3}

\subsection{Module}

ImportDM3

\subsection{Uses}
\begin{itemize}
	\item Array data structure
	\item Hardware hiding
	\item Data Spectrum Image
\end{itemize}

\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
ReadDM3 & filename: string & SI: $\mathbb{R}^{X \times Y \times E}$, metadata: dict & NO FILE, WRONG FILETYPE, NO DATA FOUND  \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\subsubsection{Environment Variables}
\begin{itemize}
\item filedm3
\end{itemize}
\subsubsection{Access Routine Semantics}

\noindent ImportDM3():
\begin{itemize}
\item input: 
\item transition:
\item output: 
\item exception: 
\end{itemize}

\section{MIS of Import h5 Module} \label{Mod:ImportH5} 

\subsection{Module}

ImportH5

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}


\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Import rpl Module} \label{Mod:ImportRPL}

\subsection{Module}

ImportRPL

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}


\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Export csv Module} \label{Mod:ExportCSV}

\subsection{Module}

ExportCSV

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
WriteCSV & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}


\subsubsection{Access Routine Semantics}

\noindent WriteCSV():
\begin{itemize}
\item transition: Writes data to csv file 
\item output: csv file
\item exception:
\end{itemize}

\noindent FormatCSV():
\begin{itemize}
\item transition: Formats data to prepare it to write to csv file 
\item output: formatted data
\item exception:
\end{itemize}

\noindent Verify1D():
\begin{itemize}
\item transition: Verifies that the input data is of the correct format (a 1D spectrum) and has a spectral range and an intensity array of equal length
\item output: formatted data
\item exception:
\end{itemize}

\section{MIS of Export h5 Module} \label{Mod:ExportH5}

\subsection{Module}

ExportH5

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}


\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Export png Module} \label{Mod:ExportPNG}

\subsection{Module}

ExportPNG

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}


\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Export rpl Module} \label{Mod:ExportRPL}

\subsection{Module}

ExportRPL

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}


\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Data Processing Richardson-Lucy Deconvolution Module} \label{Mod: RLDeconvolution}

\subsection{Module}

RLDeconvolution

\subsection{Uses}
Array Data Structure

\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
RLDeconvolution & S, iterations, S, threads & deconvolved S & - \\
SIDeconvolution & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
N/A
%\begin{itemize}
%\item iterations
%\item PSF
%\item spectrum
%\item threads
%\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent RLDeconvolution():
\begin{itemize}
\item input: S, S, iterations, threads
\item transition:  
\item output: deconvolved spectrum
\item exception: Divide by zero!
\end{itemize}

\noindent SIDeconvolution():
\begin{itemize}
\item input: SI, iterations, S, threads
\item transition: 
\item output: Deconvolved spectrum image
\item exception: divide by zero
\end{itemize}

\section{MIS of Data Processing Normalization Module} \label{Mod:Normalization}

\subsection{Module}

Normalization

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}


\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Data Processing Gain Correction Module} \label{Mod:GainCorr}

\subsection{Module}

GainCorr

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}


\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Data Processing Background Correction Module} \label{Mod:BackgroundCorr}

\subsection{Module}

BackgroundCorr

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}


\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Data Extraction 1D Slice Module} \label{Mod:Slice1D}

\subsection{Module}

Slice1D

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
CreateMask & - & - & - \\
ApplyMask & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}
\item Mask (2D array of booleans)
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent CreateMask():
\begin{itemize}
\item transition: Creation of the mask for a 2d dataset - relies on user interaction
\item output:  
\item exception:  
\end{itemize}
\an{should this be here, or in display?}

\noindent ApplyMask():
\begin{itemize}
\item transition: Applies 2d mask to dataset
\item output:  
\item exception:  
\end{itemize}

\section{MIS of Data Extraction 2D Mask Module} \label{Mod:Mask2D}

\subsection{Module}

Mask2D

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
Create mask & keyboard event, mouse event, data size & 2d bool mask of data size & - \\
Apply mask & & & \\
Modify mask & & & \\

\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}
\item mask2D
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Data Extraction 3D Mask Module} \label{Mod:Mask3D}

\subsection{Module}

Mask3D

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
mask3d

\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Display 1D Spectrum Module} \label{Mod:Disp1D}

\subsection{Module}

Disp1D

\subsection{Uses}
Data 1D Spectrum
Plotting library

\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
plot & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\subsubsection{Environment Variables}
fig

\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Display 2D Image Module} \label{Mod:Disp2D}

\subsection{Module}

Disp2D

\subsection{Uses}


\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}


\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Display 3D Spectrum Image Module} \label{Mod:Disp3D}

\subsection{Module}

Disp3D

\subsection{Uses}
\begin{itemize}
	\item Data
	\item Plotting library
	\item 2D image plot
	\item 1D spectrum plot
\end{itemize}

\subsection{Syntax}


\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\wss{accessProg} & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}
	\item axis2D image
	\item axis1D spectrum
	\item axis2D mask
	\item axis1D contrast
	\item axis colourbar
	\item polygons
	\item slicer
\end{itemize}
\an{do polygons and slicer belong here, or in the mask2d and slice1d modules?}

\subsubsection{Environment Variables}
\begin{itemize}
\item Plotting window displayed on screen
\item Keyboard keys and mouse buttons
\end{itemize}


\subsubsection{Access Routine Semantics}

\noindent \wss{accessProg}():
\begin{itemize}
\item transition: \wss{if appropriate} 
\item output: \wss{if appropriate} 
\item exception: \wss{if appropriate} 
\end{itemize}

\section{MIS of Data 1D Spectrum Module} \label{Mod:Spectrum}
\subsection{Template Module}
Spectrum

\subsection{Uses}
\begin{itemize}
\item \hyperref[Mod:Array]{Array data structure}
\end{itemize}

\subsection{Syntax}

\subsubsection{Types}
Spectrum

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{1.5cm} p{4cm} p{4cm} p{4cm}}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\midrule
init & data, (Srange $|$ (dispersion $\&$ [index, value])), Slabel, Sunit & - & WRONG DATA TYPE, LENGTH MISMATCH \\
\bottomrule
\end{tabular}
\end{center}

\subsection{Semantics}
This module contains the abstract data type Spectrum, including the following state variables.
\subsubsection{State Variables}
\begin{itemize}
\item \textit{SRange}: $\mathbb{R}^K$
\item \textit{data}: $\mathbb{R}^K$
\item \textit{index}: $\mathbb{Z}$
\item \textit{value}: $\mathbb{R}$
\item \textit{dispersion}: $\mathbb{R}$
\item \textit{Slabel}: \textit{str}
\item \textit{Sunit}: \textit{str}
\item \textit{metadata}: \textit{dict}
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent init():
init initializes a Spectrum object.
\begin{itemize}
    \item input:
    \begin{itemize}
        \item \textit{data}: intensity values, $\in \mathbb{R}^K$
        \item \textit{Srange}: spectral axis values, $\in \mathbb{R}^K$
        \item \textit{dispersion}: difference  between neighbouring channels along the spectral axis,  $\mathbb{R}$
        \item \textit{index}: location on the spectral axis at which \textit{value} is, $\mathbb{Z}$
        \item \textit{value}: value of the spectral axis (in spectral axis units) at the location given by \textit{index}, $\mathbb{R}$
        \item \textit{Slabel}: spectrum label, the name for the spectral axis (\textit{e.g.} Energy, Wavelength), \textit{str}
        \item \textit{Sunit}: spectrum units, the units which the spectral axis uses (\textit{e.g.} \si{\electronvolt}, \si{\nano\metre}), \textit{str}
    \end{itemize}
    \item transition: Creates all state variables
    \item output: N/A
    \item exception:
\begin{center}
    \begin{tabular}{p{3cm} p{12cm}}
        \toprule[0.15em]
        \textbf{Exception} & \textbf{Condition}\\
        \midrule[0.1em]
        WRONG DATA TYPE & Any of the input data are the wrong type\\ 
        \midrule[0.05em]
        LENGTH MISMATCH & The length of Srange is not the same as the length of data\\
        & $len(Srange) \neq len(data)$\\
        \bottomrule[0.15em]
    \end{tabular}
\end{center}
\end{itemize}

\section{MIS of Data 2D Image Module} \label{Mod:Image}

\subsection{Template Module}
Image

\subsection{Uses}
\begin{itemize}
    \item \hyperref[Mod:Array]{Array data structure}
\end{itemize}

\subsection{Syntax}
\subsubsection{Types}
Image

\subsubsection{Exported Access Programs}

\begin{center}
    \begin{tabular}{p{1.5cm} p{4cm} p{4cm} p{4cm}}
        \toprule
        \textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
        \midrule
        init & data, Imcal, metadata & - & WRONG DATA TYPE, WRONG DIMENSIONS \\
        \bottomrule
    \end{tabular}
\end{center}

\subsection{Semantics}
This module contains the abstract data type Spectrum, including the following state variables.
\subsubsection{State Variables}
\begin{itemize}
    \item data: $\mathbb{R}^{X \times Y}$
    \item Imcal: $\mathbb{R}$
    \item metadata: dict
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent init():
init initializes an Image object.
\begin{itemize}
    \item input:
    \begin{itemize}
        \item \textit{data}: intensity values, $\in \mathbb{R}^{X \times Y}$
        \item \textit{Imcal}: image calibration values (\textit{e.g.} number of \si{\nano\metre} per pixel), $\in \mathbb{R}$
        \item \textit{metadata}: dictionary containing extra information about the source of the image (\textit{e.g.} experimental parameters)
    \end{itemize}
    \item transition: Creates all state variables
    \item output: N/A
    \item exception:
    \begin{center}
        \begin{tabular}{p{4cm} p{11.5cm}}
            \toprule[0.15em]
            \textbf{Exception} & \textbf{Condition}\\
            \midrule[0.1em]
            WRONG DATA TYPE & The input data are not real numbers or the Imcal value is not a real float\\
            & $data \notin \mathbb{R}^{X \times Y}  | Imcal \notin \mathbb{R} \Rightarrow$ WRONG\_DATA\_TYPE \\ 
            \midrule[0.05em]
            WRONG DIMENSIONS & The input data is not 2D\\
            & $size(data) \notin \mathbb{N}^2 \Rightarrow $ WRONG\_DIMENSIONS\\
            \bottomrule[0.15em]
        \end{tabular}
    \end{center}
\end{itemize}

\section{MIS of Data 3D Spectrum Image Module} \label{Mod:SI}

\subsection{Template Module}
SI

\subsection{Uses}
\begin{itemize}
	\item Array Data Structure
\end{itemize}


\subsubsection{Types}
Spectrum Image

\subsubsection{Exported Access Programs}

\begin{center}
    \begin{tabular}{p{1.5cm} p{4cm} p{4cm} p{4cm}}
        \toprule
        \textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
        \midrule
        init & data, Srange $|$ dispersion $\&$ [index, value], Slabel, Sunit, Imcal, metadata & - & WRONG DATA TYPE, WRONG DIMENSIONS \\
        \bottomrule
    \end{tabular}
\end{center}

\subsection{Semantics}
This module holds spectrum image data (a 3D dataset) and associated calibrations and other related information.

\subsubsection{State Variables}
\begin{itemize}
	\item \textit{data}: $\mathbb{R}^{X \times Y \times K}$
	\item \textit{Imcal}: $\mathbb{R}$
	\item \textit{dispersion}: $\mathbb{R}$
	\item \textit{Srange}: $\mathbb{R}^{K}$
    \item \textit{index}: $\mathbb{Z}$
    \item \textit{value}: $\mathbb{R}$
	\item \textit{Slabel}: string
	\item \textit{Sunit}: string
	\item \textit{metadata}: dict
\end{itemize}

\subsubsection{Access Routine Semantics}
init
\begin{itemize}
\item input: 
    \begin{itemize}
        \item \textit{data}: intensity values, $\in \mathbb{R}^{X \times Y \times K}$
        \item \textit{Srange}: spectral axis values, $\in \mathbb{R}^K$
        \item \textit{dispersion}: difference  between neighbouring channels along the spectral axis,  $\mathbb{R}$
        \item \textit{index}: location on the spectral axis at which \textit{value} is, $\mathbb{Z}$
        \item \textit{value}: value of the spectral axis (in spectral axis units) at the location given by \textit{index}, $\mathbb{R}$
        \item \textit{Slabel}: spectrum label, the name for the spectral axis (\textit{e.g.} Energy, Wavelength), \textit{str}
        \item \textit{Sunit}: spectrum units, the units which the spectral axis uses (\textit{e.g.} \si{\electronvolt}, \si{\nano\metre}), \textit{str}
        \item \textit{Imcal}: image calibration values (\textit{e.g.} number of \si{\nano\metre} per pixel), $\in \mathbb{R}$
        \item \textit{metadata}: dictionary containing extra information about the source of the image (\textit{e.g.} experimental parameters)
    \end{itemize}
\item transition: Initialize all state variables
\item output: N/A
\item exception: 
\begin{center}
    \begin{tabular}{p{3cm} p{12cm}}
        \toprule[0.15em]
        \textbf{Exception} & \textbf{Condition}\\
        \midrule[0.1em]
        WRONG DATA TYPE & Any of the input data are the wrong type\\
        & $(data \notin \mathbb{R}^{X \times Y \times K}) | (Srange \notin \mathbb{R}^K) | (dispersion \notin \mathbb{R}) | (index \notin \mathbb{Z}) | (value \notin \mathbb{R}) | (Slabel \notin str) | (Sunit \notin str) | (Imcal \notin \mathbb{R}) \Rightarrow$ WRONG\_DATA\_TYPE\\ 
        \midrule[0.05em]
        LENGTH MISMATCH & The length of Srange is not the same as the length of data's spectral axis\\
        & $len(Srange) \neq size(data)[2] \Rightarrow$ LENGTH\_MISMATCH\\
        \midrule[0.05em]
        WRONG DATA TYPE & The input data are not real numbers or the Imcal value is not a real float\\
        & $data \notin \mathbb{R}^{X \times Y}  | Imcal \notin \mathbb{R} \Rightarrow$ WRONG\_DATA\_TYPE \\ 
        \midrule[0.05em]
        WRONG DIMENSIONS & The input data is not 2D\\
        & $size(data) \notin \mathbb{N}^2 \Rightarrow $ WRONG\_DIMENSIONS\\
        \bottomrule[0.15em]
    \end{tabular}
\end{center}
\end{itemize}

\section{MIS of Array Data Structure Module} \label{Mod:Array}

\subsection{Template Module}

Array

\subsection{Uses}
N/A

\subsection{Syntax}

\subsubsection{Type}
\begin{itemize}
    \item Array
\end{itemize}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
CreateArray & data & Array & - \\
ModifyArray & Array & Array & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}
    \item Array: $\mathbb{C}^N, dim(N) \in \mathbb{N}$
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent CreateArray():
\begin{itemize}
    \item input: data, $\mathbb{C}^N$
    \item transition: Create array variable
    \item output: Array, $\mathbb{C}^N$
    \item exception: N/A
\end{itemize}

\noindent ModifyArray():
\begin{itemize}
    \item input: Array, $\mathbb{C}^N$
    \item transition: Modify array by some operation, including but not limited to, addition, subtraction, multiplication, division, \textit{etc.}
    \item output: Array, $\mathbb{C}^N$
    \item exception: N/A
\end{itemize}

\section{MIS of Plotting Library Module} \label{Mod:Plotting}

\subsection{Module}

Plotting

\subsection{Uses}
\begin{itemize}
    \item \hyperref[Mod:HH]{Hardware Hiding Module}
\end{itemize}

\subsection{Syntax}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
plot & data & window & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}
    \item figure
    \item 1D plot axis
    \item 2D plot axis
    \item event handler
\end{itemize}

\subsubsection{Environment Variables}
\begin{itemize}
    \item window: 2D on-screen display of plot figure
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent plot():
\begin{itemize}
    \item input: data, $\mathbb{R}^{K} | \mathbb{R}^{X \times Y}$
    \item transition: Creates a figure to display the input data, with a 1D plot axis for 1D data or a 2D plot axis for 2D data. Provides handling for events such as mouse clicks or keyboard key presses and options to format the display.
    \item output: window
    \item exception:
\end{itemize}

\newpage

\bibliography {MIS}

\newpage

\section{Appendix} \label{Appendix}

\wss{Extra information if required}

\end{document}